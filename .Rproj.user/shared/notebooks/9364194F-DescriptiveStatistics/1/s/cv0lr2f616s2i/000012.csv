"0","# Define heatmaps for each group"
"0","# Define heatmaps for each group"
"0","heatmapPISANL <- data %>%"
"0","  filter(!is.na(PV1), !is.na(mean_response_time), whichData == ""PISANL"") %>%"
"0","  ggplot(aes(x = PV1, y = mean_response_time)) +"
"0","  geom_bin2d(bins = 30) +"
"0","  scale_fill_gradientn("
"0","    colors = c(""#e9ecef"", ""#69b3a2"", ""#404080"", ""#1d3557""),"
"0","    name = ""Count"","
"0","    breaks = function(x) round(seq(0, max(x, na.rm = TRUE), length.out = 4)),"
"0","    limits = function(x) c(0, max(x, na.rm = TRUE)),"
"0","    labels = function(x) round(x)"
"0","  ) +"
"0","  theme_minimal() +"
"0","  labs(title = NULL) +"
"0","  theme(strip.text = element_text(face = ""bold""),"
"0","        axis.title.x = element_blank(),"
"0","        axis.title.y = element_blank())"
"0",""
"0","heatmapPISAOthers <- data %>%"
"0","  filter(!is.na(PV1), !is.na(mean_response_time), whichData == ""PISAOthers"") %>%"
"0","  ggplot(aes(x = PV1, y = mean_response_time)) +"
"0","  geom_bin2d(bins = 30) +"
"0","  scale_fill_gradientn("
"0","    colors = c(""#e9ecef"", ""#69b3a2"", ""#404080"", ""#1d3557""),"
"0","    name = ""Count"","
"0","    breaks = function(x) round(seq(0, max(x, na.rm = TRUE), length.out = 4)),"
"0","    limits = function(x) c(0, max(x, na.rm = TRUE)),"
"0","    labels = function(x) round(x)"
"0","  ) +"
"0","  theme_minimal() +"
"0","  labs(title = NULL) +"
"0","  theme(strip.text = element_text(face = ""bold""),"
"0","        axis.title.x = element_blank(),"
"0","        axis.title.y = element_blank())"
"0",""
"0","heatmapTIMSSNL <- data %>%"
"0","  filter(!is.na(PV1), !is.na(mean_response_time), whichData == ""TIMSSNL"") %>%"
"0","  ggplot(aes(x = PV1, y = mean_response_time)) +"
"0","  geom_bin2d(bins = 30) +"
"0","  scale_fill_gradientn("
"0","    colors = c(""#e9ecef"", ""#69b3a2"", ""#404080"", ""#1d3557""),"
"0","    name = ""Count"","
"0","    breaks = function(x) round(seq(0, max(x, na.rm = TRUE), length.out = 4)),"
"0","    limits = function(x) c(0, max(x, na.rm = TRUE)),"
"0","    labels = function(x) round(x)"
"0","  ) +"
"0","  theme_minimal() +"
"0","  labs(title = NULL) +"
"0","  theme(strip.text = element_text(face = ""bold""),"
"0","        axis.title.x = element_blank(),"
"0","        axis.title.y = element_blank())"
"0",""
"0","heatmapTIMSSOthers <- data %>%"
"0","  filter(!is.na(PV1), !is.na(mean_response_time), whichData == ""TIMSSOthers"") %>%"
"0","  ggplot(aes(x = PV1, y = mean_response_time)) +"
"0","  geom_bin2d(bins = 30) +"
"0","  scale_fill_gradientn("
"0","    colors = c(""#e9ecef"", ""#69b3a2"", ""#404080"", ""#1d3557""),"
"0","    name = ""Count"","
"0","    breaks = function(x) round(seq(0, max(x, na.rm = TRUE), length.out = 4)),"
"0","    limits = function(x) c(0, max(x, na.rm = TRUE)),"
"0","    labels = function(x) round(x)"
"0","  ) +"
"0","  theme_minimal() +"
"0","  labs(title = NULL) +"
"0","  theme(strip.text = element_text(face = ""bold""),"
"0","        axis.title.x = element_blank(),"
"0","        axis.title.y = element_blank())"
"0",""
"0","# Check if data is non-empty before plotting"
"0","if (nrow(data %>% filter(!is.na(PV1), !is.na(mean_response_time))) > 0) {"
"0","  # Arrange heatmaps in a 2x2 grid with facet-like labels"
"0","  combined_plot <- arrangeGrob("
"0","    heatmapPISANL + facet_wrap(~ whichData, labeller = labeller(whichData = c(""PISANL"" = ""PISA NL""))),"
"0","    heatmapPISAOthers + facet_wrap(~ whichData, labeller = labeller(whichData = c(""PISAOthers"" = ""PISA Others""))),"
"0","    heatmapTIMSSNL + facet_wrap(~ whichData, labeller = labeller(whichData = c(""TIMSSNL"" = ""TIMSS NL""))),"
"0","    heatmapTIMSSOthers + facet_wrap(~ whichData, labeller = labeller(whichData = c(""TIMSSOthers"" = ""TIMSS Others""))),"
"0","    nrow = 2, ncol = 2,"
"0","    bottom = textGrob(""Plausible Value 1"", gp = gpar(fontsize = 12)),"
"0","    left = textGrob(""Mean Response Time"", rot = 90, gp = gpar(fontsize = 12))"
"0","  )"
"0","  "
"0","  # Display the combined plot"
"0","  grid.arrange(combined_plot)"
"0","  "
"0","  # Save the combined plot"
"0","  ggsave(""pv1_response_time_heatmaps_grid.png"", "
"0","         combined_plot,"
"0","         width = 10, height = 8, dpi = 300, path = ""../Output/"")"
"0","}"
