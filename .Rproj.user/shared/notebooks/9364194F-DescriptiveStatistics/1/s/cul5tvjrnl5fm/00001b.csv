"0","data <- data %>%"
"0","  mutate(gender = as.numeric(as.character(gender)),  # Convert factor to numeric"
"0","         gender = ifelse(whichData %in% c(""TIMSSNL"", ""TIMSSOthers""),"
"0","                         gender - 1,"
"0","                         gender))"
"0",""
"0","# Create barplot "
"0","GenderPlot <- data %>%"
"0","  filter(!is.na(gender)) %>%"
"0","  group_by(whichData, Set, gender) %>%"
"0","  summarise(count = n(), .groups = ""drop"") %>%"
"0","  group_by(whichData, Set) %>%"
"0","  mutate(percentage = count / sum(count) * 100) %>%"
"0","  ungroup() %>%"
"0","  ggplot(aes(x = whichData, y = percentage, fill = interaction(Set, gender))) +"
"0","  geom_col(position = ""dodge"", color = ""#e9ecef"") +"
"0","  scale_fill_manual(values = c(""Test.0"" = ""#69b3a2"", ""Train.0"" = ""#404080"", "
"0","                              ""Test.1"" = ""#8cedd8"", ""Train.1"" = ""#7070db""),"
"0","                    labels = c(""Test.0"" = ""Test Female"", ""Train.0"" = ""Train Female"","
"0","                               ""Test.1"" = ""Test Male"", ""Train.1"" = ""Train Male""),"
"0","                    name = ""Dataset and Gender"") +"
"0","  theme_minimal() +"
"0","  labs(x = ""Group"", y = ""Percentage (%)"") +"
"0","  theme(plot.title = element_text(face = ""bold""),"
"0","        legend.title = element_text(face = ""bold""))"
"0","GenderPlot"
